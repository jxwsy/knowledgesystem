# 协同过滤

协同过滤，它计算用户间偏好的相似性，在相似用户的基础上自动的为目标用户进行过滤和筛选，其基本思想为具有相同或相似的价值观、思想观、知识水平和兴趣偏好的用户，其对信息的需求也是相似的。因此相对于传统的推荐方法，协同过滤技术体现出的一个显著的优势是能够推荐一些难以进行内容分析的项目，比如信息质量、个人品味等抽象的资源对象。另外协同过滤技术能够有效的使用其他兴趣相似用户的评价信息，从而利用较少的用户反馈，加快了个性化学习的速度，同时利于发现用户的隐藏兴趣。

##预处理

在处理数据前，需要对数据进行一定的预处理，其中最核心的工作就是：减噪和归一化。

	减噪 
	用户行为数据是用户在使用应用过程中产生的，它可能存在大量的噪音和用户的误操作，
	我们可以通过经典的数据挖掘算法过滤掉行为数据中的噪音，这样可以是我们的分析更加精确。
	
	归一化 
	不同行为的数据取值可能相差很大，比如，用户的查看数据必然比购买数据大的多，如何将各
	个行为的数据统一在一个相同的取值范围中，从而使得加权求和得到的总体喜好更加精确，就
	需要我们进行归一化处理。最简单的归一化处理，就是将各类数据除以此类中的最大值，以保
	证归一化后的数据取值在 [0,1] 范围中。

进行的预处理后，根据不同应用的行为分析方法，可以选择分组或者加权处理，之后我们可以得到一个用户偏好的二维矩阵，一维是用户列表，另一维是物品列表，值是用户对物品的偏好，一般是 [0,1] 或者 [-1, 1] 的浮点数值。

	将不同的行为分组  ？？？
	一般可以分为“查看”和“购买”等等，然后基于不同的行为，计算不同的用户 / 物品相似度。
	类似于当当网或者 Amazon 给出的“购买了该图书的人还购买了 ...”，“查看了图书的人还查看了 ...”
	
	加权操作 
	根据不同行为反映用户喜好的程度将它们进行加权，得到用户对于物品的总体喜好。一般来说，
	显式的用户反馈比隐式的权值大，但比较稀疏，毕竟进行显示反馈的用户是少数；同时相对于“查看”，“购买”行为反映用户喜好的程度更大，但这也因应用而异。

## 相似度


	欧几里德距离、皮尔逊相关系数、Cosine 相似度、Jaccard相似系数

## 相似邻居的选择

	1、根据点之间的距离，我们取最近的k个点（对于孤立点的计算效果不好）
	2、落在以当前点为中心，距离为 K 的区域中的所有点都作为当前点的邻居（计算得到的邻居个数不确定）

## 协同过滤算法

	常用协同过滤算法：基于内存的协同过滤推荐，基于模型的协同过滤推荐。
	
	基于内存的协同过滤算法分为两类：基于user的协同过滤；基于item的协同过滤

### 基于用户的 CF（User CF）

基于用户的 CF 的基本思想相当简单，基于用户对物品的偏好找到相邻邻居用户，然后将邻居用户喜欢的推荐给当前用户。
计算上，就是将一个用户对所有物品的偏好作为一个向量来计算用户之间的相似度，找到 K 邻居后，根据邻居的相似度权重
以及他们对物品的偏好，预测当前用户没有偏好的未涉及物品，计算得到一个排序的物品列表作为推荐。

分为直接推荐和加权排序推荐

直接推荐：假如我们需要为用户P5推荐电影，首先我们检查相似度列表，发现用户P5和用户P3的相似度最高。
因此，我们可以对用户P5推荐P3的相关数据。但这里有一个问题。我们不能直接推荐前面A-F的商品。
因为这这些商品用户P5已经浏览或者购买过了。不能重复推荐。
因此我们要推荐用户P5还没有浏览或购买过的商品。如果直接推荐我们可以选择P3用户评价最高的商品，
也就是环太平洋和变形金刚两个数据。

加权排序推荐：我们根据不同用户间的相似度，对不同商品的评分进行相似度加权。按加权后的结果对商品进行排序，然后推荐给用户P5。
这样，用户P5就获得了更好的推荐结果。

### 基于物品的 CF（Item CF）

将所有用户对某个物品的偏好作为一个向量来计算物品之间的相似度，得到物品的相似物品后，根据用户历史的偏好预测当前用户还没有表示偏好的物品，计算得到一个排序的物品列表作为推荐。

### 两种算法的比较

	复杂度：
	对提供商品的电子商务网站：用户的数量往往大大超过物品的数量，同时物品的数据相对稳定，
	因此计算物品的相似度不但计算量较小，同时也不必频繁更新。
	对于新闻，博客或者微内容的推荐系统，情况往往是相反的，物品的数量是海量的，同时也是更
	新频繁的。

	======================================================================
	适用场景：
	购书网站上，当你看一本书的时候，推荐引擎会给你推荐相关的书籍，这个推荐的重要性远远超
	过了网站首页对该用户的综合推荐。可以看到，在这种情况下，Item CF 的推荐成为了引导用户
	浏览的重要手段。同时 Item CF 便于为推荐做出解释，在一个非社交网络的网站中，给某个用户
	推荐一本书，同时给出的解释是某某和你有相似兴趣的人也看了这本书，这很难让用户信服，因为
	用户可能根本不认识那个人。
	在现今很流行的社交网络站点中，User CF 是一个更不错的选择，User CF 加上社会网络信息，
	可以增加用户对推荐解释的信服程度。
	======================================================================
	推荐多样性：
	第一种度量方法是从单个用户的角度度量，就是说给定一个用户，查看系统给出的推荐列表是否多
	样，也就是要比较推荐列表中的物品之间两两的相似度，不难想到，对这种度量方法，Item CF 
	的多样性显然不如 User CF 的好，因为 Item CF 的推荐就是和以前看的东西最相似的。
	第二种度量方法是考虑系统的多样性，也被称为覆盖率 (Coverage)，它是指一个推荐系统是否能
	够提供给所有用户丰富的选择。在这种指标下，Item CF 的多样性要远远好于 User CF, 因为 
	User CF 总是倾向于推荐热门的，从另一个侧面看，也就是说，Item CF 的推荐有很好的新颖
	性，很擅长推荐长尾里的物品。所以，尽管大多数情况，Item CF 的精度略小于 User CF， 但如
	果考虑多样性，Item CF 却比 User CF 好很多。


### 基于模型的协同过滤推荐

基于模型的协同过滤推荐就是基于样本的用户偏好信息，训练一个推荐模型，然后根据实时的用户喜好的信息进行预测，计算推荐。

换言之，m个物品，m个用户的数据，只有部分用户和部分数据之间是有评分数据的，其它部分评分是空白，此时我们要用已有的部分稀疏数据来预测那些空白的物品和数据之间的评分关系，找到最高评分的物品推荐给用户。

对于这个问题，用机器学习的思想来建模解决，主流的方法可以分为：用关联算法，聚类算法，分类算法，回归算法，矩阵分解，神经网络,图模型以及隐语义模型来解决。

	https://www.cnblogs.com/chenliyang/p/6548306.html


## 存在以下几个问题：

	（1）方法的核心是基于历史数据，所以对新物品和新用户都有“冷启动”的问题。
	（2）推荐的效果依赖于用户历史偏好数据的多少和准确性。
	（3）在大部分的实现中，用户历史偏好是用稀疏矩阵进行存储的，而稀疏矩阵上的计算有些明显的问题，包括可能少部分人的错误偏好会对推荐的准确度有很大的影响等等。
	（4）对于一些特殊品味的用户不能给予很好的推荐。
	（5）由于以历史数据为基础，抓取和建模用户的偏好后，很难修改或者根据用户的使用演变，从而导致这个方法不够灵活。

===================

	https://blog.csdn.net/xiaokang123456kao/article/details/74735992
	https://blog.csdn.net/zolalad/article/details/51104745
	https://blog.csdn.net/jie310300215/article/details/50498216
	https://blog.csdn.net/pang_hailong/article/details/53046330?locationNum=12&fps=1
	https://blog.csdn.net/csj941227/article/details/78202638
	https://blog.csdn.net/skynumone/article/details/43340053


### ALS算法

	https://blog.csdn.net/u010670689/article/details/73611884
	https://blog.csdn.net/oucpowerman/article/details/49847979